# 실무 인사이트

## 코드 리뷰 관점

**리뷰어가 좋아하는 PR:**
- 한 가지 목적만 달성하는 작은 PR
- 변경 이유가 명확한 커밋 메시지
- 테스트가 함께 있는 코드
- self-review 코멘트가 있는 PR

**리뷰어가 싫어하는 PR:**
- 500줄 이상의 대형 PR
- "리팩토링"이라면서 기능도 바꾼 PR
- 테스트 없이 "잘 동작합니다"
- 왜 이렇게 했는지 설명 없는 PR

## 실무에서 자주 하는 실수

### 1. 낙관적 동시성 미고려
- 동시에 같은 데이터 수정 시 문제
- 해결: `@Version` 낙관적 락 또는 비관적 락

### 2. N+1 쿼리
- 연관 엔티티 조회 시 쿼리 폭발
- 해결: `fetch join`, `@EntityGraph`, 별도 쿼리

### 3. 트랜잭션 범위 과다
- 긴 트랜잭션 = DB 커넥션 점유 = 장애
- 해결: 트랜잭션 최소화, 외부 API 호출은 트랜잭션 밖에서

### 4. 로깅 부족/과다
- 장애 시 원인 파악 불가 vs 로그 비용 폭발
- 해결: 적절한 로그 레벨, 구조화된 로깅

### 5. 하드코딩
- 환경별로 달라지는 값이 코드에 박힘
- 해결: 설정 파일, 환경변수 활용

## 협업 마인드셋

**코드는 혼자 보는 게 아니다:**
- 3개월 후의 나도 "남"이다
- 코드 리뷰어의 시간을 아껴주자
- "왜 이렇게 했는지" 설명할 수 있어야 한다

**완벽보다 점진적 개선:**
- 처음부터 완벽한 설계는 없다
- 일단 동작하게 → 리팩토링으로 개선
- 단, 테스트가 있어야 안전하게 개선 가능

**기술 부채 관리:**
- TODO 주석은 이슈로 등록
- "나중에 고치자"는 대부분 안 고쳐짐
- 부채를 만들 때 상환 계획도 함께

## 에러 처리 계층

```
Controller  → 입력 형식 에러 (400)
Service     → 비즈니스 규칙 위반 (400, 409)
Repository  → 데이터 없음 (404)
Global      → 예상치 못한 에러 (500)
```
